"use strict";jQuery.fn.selectToUISlider=function(settings){function isArray(obj){return obj.constructor===Array}function ttText(optIndex){return"text"==options.tooltipSrc?selectOptions[optIndex].text:selectOptions[optIndex].value}function leftVal(i){return(i/(selectOptions.length-1)*100).toFixed(2)+"%"}var selects=jQuery(this),options=jQuery.extend({labels:3,tooltip:!0,tooltipSrc:"text",labelSrc:"value",minRange:0,sliderOptions:null},settings),handleIds=function(){var tempArr=[];return selects.each(function(){tempArr.push("handle_"+jQuery(this).attr("id"))}),tempArr}(),selectOptions=function(){var opts=[];return selects.eq(0).find("option").each(function(){opts.push({value:jQuery(this).attr("value"),text:jQuery(this).text()})}),opts}(),groups=function(){if(selects.eq(0).find("optgroup").size()>0){var groupedData=[];return selects.eq(0).find("optgroup").each(function(i){groupedData[i]={},groupedData[i].label=jQuery(this).attr("label"),groupedData[i].options=[],jQuery(this).find("option").each(function(){groupedData[i].options.push({text:jQuery(this).text(),value:jQuery(this).attr("value"),disabled:jQuery(this).attr("disabled"),markers:jQuery(this).data("markers")})})}),groupedData}}(),sliderOptions={step:1,min:0,orientation:"horizontal",max:selectOptions.length-1,range:selects.length>1,slide:function(e,ui){var thisHandle=jQuery(ui.handle);if(sliderOptions.range&&ui.values[1]-ui.values[0]<=options.minRange-1)return!1;var currSelect=jQuery("#"+thisHandle.attr("id").split("handle_")[1]),option=currSelect.find("option").eq(ui.value);if("disabled"==option.attr("disabled"))return!1;var textval=ttText(ui.value);thisHandle.attr("aria-valuetext",textval).attr("aria-valuenow",ui.value).find(".ui-slider-tooltip .ttContent").text(textval),currSelect.val(option.val()),currSelect.trigger("sliderchange",[textval]),currSelect.trigger(jQuery.Event("change",{uiSliderEvent:e,uiSliderContext:ui}))},values:function(){var values=[];return selects.each(function(){values.push(jQuery(this).get(0).selectedIndex)}),values}()};options.sliderOptions=settings?jQuery.extend(sliderOptions,settings.sliderOptions):sliderOptions,selects.bind("change keyup click",function(){var thisIndex=jQuery(this).get(0).selectedIndex,thisHandle=jQuery("#handle_"+jQuery(this).attr("id")),handleIndex=thisHandle.data("handleNum");thisHandle.parents(".ui-slider:eq(0)").slider("values",handleIndex,thisIndex)});var sliderComponent=jQuery("<div></div>");selects.each(function(i){var hidett="",disabled="disabled"==jQuery(this).attr("disabled"),thisLabel=jQuery("label[for="+jQuery(this).attr("id")+"]"),labelText=thisLabel.size()>0?"Slider control for "+thisLabel.text():"",thisLabelId=thisLabel.attr("id")||thisLabel.attr("id","label_"+handleIds[i]).attr("id"),hclass="ui-slider-handle";disabled&&(hclass+=" ui-slider-handle-disabled"),options.tooltip===!1&&(hidett=' style="display: none;"'),jQuery('<a href="#" tabindex="0" id="'+handleIds[i]+'" class="'+hclass+'" role="slider" aria-labelledby="'+thisLabelId+'" aria-valuemin="'+options.sliderOptions.min+'" aria-valuemax="'+options.sliderOptions.max+'" aria-valuenow="'+options.sliderOptions.values[i]+'" aria-valuetext="'+ttText(options.sliderOptions.values[i])+'" ><span class="screenReaderContext">'+labelText+'</span><span class="ui-slider-tooltip ui-widget-content ui-corner-all"'+hidett+'><span class="ttContent"></span><span class="ui-tooltip-pointer-down ui-widget-content"><span class="ui-tooltip-pointer-down-inner"></span></span></span></a>').data("handleNum",i).appendTo(sliderComponent)});var scale;if(groups){var inc=0;scale=sliderComponent.append('<dl class="ui-slider-scale ui-helper-reset" role="presentation"></dl>').find(".ui-slider-scale:eq(0)"),jQuery(groups).each(function(h,group){scale.append('<dt style="width: '+(100/groups.length).toFixed(2)+"%; left:"+(h/(groups.length-1)*100).toFixed(2)+'%"><span>'+this.label+"</span></dt>");var groupOpts=this.options;jQuery(this.options).each(function(i,opt){var style=inc==selectOptions.length-1||0===inc?'style="display: none;"':"",labelText="text"==options.labelSrc?groupOpts[i].text:groupOpts[i].value,groupLabel=0===i?'<span style="position:relative"><span class="ui-slider-label-group">'+group.label+"</span></span>":"";opt.markers&&opt.markers.length>0&&jQuery.each(opt.markers,function(i,m){labelText+='<br/><span class="ui-slider-marker ui-corner-all"><a href="#">'+m+"</a></span>"});var $label=jQuery('<dd style="left:'+leftVal(inc)+'">'+groupLabel+'<span class="ui-slider-label">'+labelText+'</span><span class="ui-slider-tic ui-widget-content"'+style+"></span></dd>");"disabled"==opt.disabled&&($label.find(".ui-slider-label").addClass("ui-slider-label-disabled"),$label.find(".ui-slider-tic").addClass("ui-slider-tic-disabled"),$label.find(".ui-slider-marker").addClass("ui-slider-marker-disabled")),scale.append($label),inc++})})}else scale=sliderComponent.append('<ol class="ui-slider-scale ui-helper-reset" role="presentation"></ol>').find(".ui-slider-scale:eq(0)"),jQuery(selectOptions).each(function(i){var style=i==selectOptions.length-1||0===i?'style="display: none;"':"",labelText="text"==options.labelSrc?this.text:this.value;scale.append('<li style="left:'+leftVal(i)+'"><span class="ui-slider-label">'+labelText+'</span><span class="ui-slider-tic ui-widget-content"'+style+"></span></li>")});options.labels>1&&sliderComponent.find(".ui-slider-scale li:last span.ui-slider-label, .ui-slider-scale dd:last span.ui-slider-label").addClass("ui-slider-label-show");for(var increm=Math.max(1,Math.round(selectOptions.length/options.labels)),j=0;j<selectOptions.length;j+=increm)sliderComponent.find(".ui-slider-scale li:eq("+j+") span.ui-slider-label, .ui-slider-scale dd:eq("+j+") span.ui-slider-label").addClass("ui-slider-label-show");sliderComponent.find(".ui-slider-scale dt").each(function(i){jQuery(this).css({left:(100/groups.length*i).toFixed(2)+"%"})}),sliderComponent.insertAfter(jQuery(this).eq(this.length-1)).slider(options.sliderOptions).attr("role","application").find(".ui-slider-label").each(function(){jQuery(this).css("marginLeft",-jQuery(this).width()/2)}),sliderComponent.find(".ui-tooltip-pointer-down-inner").each(function(){var bWidth=jQuery(".ui-tooltip-pointer-down-inner").css("borderTopWidth"),bColor=jQuery(this).parents(".ui-slider-tooltip").css("backgroundColor");jQuery(this).css("border-top",bWidth+" solid "+bColor)});var values=sliderComponent.slider("values");return isArray(values)?jQuery(values).each(function(i){sliderComponent.find(".ui-slider-tooltip .ttContent").eq(i).text(ttText(this))}):sliderComponent.find(".ui-slider-tooltip .ttContent").eq(0).text(ttText(values)),this};